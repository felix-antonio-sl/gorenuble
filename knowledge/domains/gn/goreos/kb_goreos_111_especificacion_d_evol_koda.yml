# GOS-111: GORE_OS - Especificación D-EVOL (Evolución Institucional)
# ═══════════════════════════════════════════════════════════════════════════════

Manifest:
  URN: "urn:knowledge:gorenuble:goreos:111:especificacion:d_evol"
  Version: "1.0.0"
  Status: Draft

Metadata:
  Title: "GORE_OS - Especificación D-EVOL (Evolución Institucional)"
  Description: "Digitalización, automatización e inteligenciación del GORE"
  Domain: GORE_OS
  Subdomain: D-EVOL
  Created: "2024-12-14"
  Tags: [goreos, d_evol, ai, automatizacion, rag, agentes]

# ═══════════════════════════════════════════════════════════════════════════════
# VISIÓN DEL DOMINIO
# ═══════════════════════════════════════════════════════════════════════════════

Vision_Dominio:
  Proposito: >
    Impulsar la evolución institucional mediante digitalización avanzada,
    automatización de procesos y agentes de IA para desarrollo exponencial.
  
  Pilares:
    Digitalizacion:
      descripcion: "Datos como activo estratégico"
      componentes: [Lakehouse, Catálogo de datos, APIs, Linaje]
    
    Automatizacion:
      descripcion: "Procesos sin intervención manual"
      componentes: [RPA, Workflows, ETL, Validadores, Schedulers]
    
    Inteligenciacion:
      descripcion: "IA para decisiones y operaciones"
      componentes: [Agentes conversacionales, Agentes operacionales, RAG, ML]
  
  Actores:
    - "CDO (Chief Data Officer): Gobierna datos y AI"
    - "Data Engineer: Gestiona datasets y pipelines"
    - "AI Engineer: Desarrolla y entrena agentes"
    - "Usuario Final: Interactúa con agentes"
  
  KPIs:
    - { nombre: "Cobertura datos Gold", formula: "Datasets Gold / Total", meta: ">= 60%" }
    - { nombre: "Tasa automatización", formula: "Procesos automatizados / Total", meta: ">= 40%" }
    - { nombre: "Adopción agentes", formula: "Interacciones/mes", meta: ">= 500" }
    - { nombre: "Satisfacción agentes", formula: "Promedio 1-5", meta: ">= 4.0" }

# ═══════════════════════════════════════════════════════════════════════════════
# ARQUITECTURA DE DATOS (LAKEHOUSE)
# ═══════════════════════════════════════════════════════════════════════════════

Arquitectura_Datos:
  capas:
    Bronze:
      descripcion: "Datos crudos, tal como llegan"
      formato: "Parquet/Delta"
      retención: "Indefinida"
      ejemplos: ["raw_sigfe", "raw_bip", "raw_rendiciones"]
    
    Silver:
      descripcion: "Datos limpios, tipados, deduplicados"
      formato: "Delta"
      retención: "5 años"
      ejemplos: ["cleaned_convenios", "cleaned_iniciativas"]
    
    Gold:
      descripcion: "Datos agregados, listos para consumo"
      formato: "Delta"
      cache: "Materializado"
      ejemplos: ["fact_ejecucion", "dim_territorio", "agg_h_gore"]
    
    Semantic:
      descripcion: "Vistas semánticas para BI y ML"
      formato: "Views/Materialized Views"
      ejemplos: ["sem_cartera_ipr", "sem_mora_rendiciones"]

  linaje:
    descripcion: "Trazabilidad origen→destino de datos"
    herramienta: "OpenLineage compatible"
    visualizacion: "Grafo interactivo"

# ═══════════════════════════════════════════════════════════════════════════════
# CASOS DE USO - DATOS
# ═══════════════════════════════════════════════════════════════════════════════

Casos_Uso_Datos:

  CU_EVOL_001:
    nombre: "Registrar dataset"
    actor: "Data Engineer"
    flujo:
      1: "Definir metadatos (nombre, dominio, capa)"
      2: "Especificar esquema"
      3: "Configurar clasificación de datos personales"
      4: "Registrar en catálogo"

  CU_EVOL_002:
    nombre: "Crear pipeline ETL"
    actor: "Data Engineer"
    flujo:
      1: "Definir origen(es)"
      2: "Especificar transformaciones"
      3: "Definir destino"
      4: "Configurar schedule"
      5: "Registrar linaje"

  CU_EVOL_003:
    nombre: "Exponer servicio de datos"
    actor: "Data Engineer"
    flujo:
      1: "Seleccionar dataset Gold/Semantic"
      2: "Definir API (REST/GraphQL)"
      3: "Configurar autenticación"
      4: "Documentar endpoints"
      5: "Publicar en catálogo"

# ═══════════════════════════════════════════════════════════════════════════════
# CASOS DE USO - AUTOMATIZACIÓN
# ═══════════════════════════════════════════════════════════════════════════════

Casos_Uso_Automatizacion:

  CU_EVOL_010:
    nombre: "Crear automatización"
    actor: "Data Engineer"
    flujo:
      1: "Identificar proceso candidato"
      2: "Definir trigger (evento/schedule/manual)"
      3: "Implementar lógica"
      4: "Configurar manejo de errores"
      5: "Definir nivel de autonomía"
      6: "Probar en staging"
      7: "Desplegar a producción"

  CU_EVOL_011:
    nombre: "Monitorear automatizaciones"
    actor: "Data Engineer"
    flujo:
      1: "Dashboard de ejecuciones"
      2: "Ver tasa de éxito/error"
      3: "Analizar logs de fallos"
      4: "Ajustar configuración"

  Automatizaciones_Candidatas:
    - nombre: "Alerta RS por vencer"
      tipo: SCHEDULER
      frecuencia: "Diaria"
      descripcion: "Notifica iniciativas con RS próximo a vencer"
    
    - nombre: "Cálculo H_gore"
      tipo: SCHEDULER
      frecuencia: "Diaria 6am"
      descripcion: "Calcula y persiste snapshot de salud"
    
    - nombre: "Validador rendiciones"
      tipo: EVENTO
      trigger: "RendicionRecibida"
      descripcion: "Validación automática de documentos"
    
    - nombre: "Sincronización SIGFE"
      tipo: SCHEDULER
      frecuencia: "Diaria 8am"
      descripcion: "Importa ejecución presupuestaria"
    
    - nombre: "Generador reporte semanal"
      tipo: SCHEDULER
      frecuencia: "Lunes 7am"
      descripcion: "Genera y envía reporte ejecutivo"

# ═══════════════════════════════════════════════════════════════════════════════
# CASOS DE USO - AGENTES AI
# ═══════════════════════════════════════════════════════════════════════════════

Casos_Uso_Agentes:

  CU_EVOL_020:
    nombre: "Crear agente conversacional"
    actor: "AI Engineer"
    flujo:
      1: "Definir propósito y dominio"
      2: "Seleccionar modelo base"
      3: "Crear system prompt"
      4: "Vincular colecciones RAG"
      5: "Definir tools/functions disponibles"
      6: "Configurar nivel de autonomía"
      7: "Probar en sandbox"
      8: "Desplegar gradualmente"

  CU_EVOL_021:
    nombre: "Gestionar colección RAG"
    actor: "AI Engineer"
    flujo:
      1: "Crear colección"
      2: "Definir fuentes de documentos"
      3: "Configurar chunking"
      4: "Indexar documentos"
      5: "Validar calidad de retrieval"
      6: "Vincular a agentes"

  CU_EVOL_022:
    nombre: "Interactuar con agente"
    actor: "Usuario Final"
    flujo:
      1: "Acceder al agente (web/chat)"
      2: "Enviar consulta"
      3: "Agente procesa con RAG"
      4: "Agente responde"
      5: "Usuario puede dar feedback"

  CU_EVOL_023:
    nombre: "Agente ejecuta tarea operacional"
    actor: "Sistema/Usuario"
    flujo:
      1: "Trigger de tarea (evento/solicitud)"
      2: "Agente analiza entrada"
      3: "Agente genera plan de acción"
      4: "Si requiere aprobación (HITL), solicita"
      5: "Ejecuta acciones"
      6: "Registra resultado"

# ═══════════════════════════════════════════════════════════════════════════════
# AGENTES PROPUESTOS
# ═══════════════════════════════════════════════════════════════════════════════

Agentes_Propuestos:

  GORE_Assistant:
    tipo: CONVERSACIONAL
    dominio: "General"
    proposito: "Asistente general para consultas de normativa y procedimientos"
    modelo: "claude-3.5-sonnet"
    colecciones_rag: [normativa_gore, procedimientos_internos, faq]
    autonomia: BAJA_HITL
    canal: [web, teams]

  IPR_Advisor:
    tipo: CONVERSACIONAL
    dominio: "D-FIN"
    proposito: "Asesor de inversión pública regional"
    modelo: "claude-3.5-sonnet"
    colecciones_rag: [normativa_ipr, guias_sni, circulares]
    tools: [consultar_iniciativa, verificar_rs, consultar_instrumento]
    autonomia: BAJA_HITL
    canal: [web]

  Rendicion_Validator:
    tipo: OPERACIONAL
    dominio: "D-EJEC"
    proposito: "Validación automática de documentos de rendición"
    modelo: "gpt-4o"
    autonomia: MEDIA
    tareas:
      - "Validar formato documentos"
      - "Verificar RUT proveedores"
      - "Detectar duplicados"
      - "Clasificar gastos"

  Report_Generator:
    tipo: OPERACIONAL
    dominio: "D-GESTION"
    proposito: "Generación automática de reportes ejecutivos"
    modelo: "claude-3.5-sonnet"
    autonomia: ALTA
    tareas:
      - "Recopilar métricas"
      - "Generar narrativa"
      - "Crear visualizaciones"
      - "Distribuir reporte"

  Alert_Analyst:
    tipo: DECISIONAL
    dominio: "D-GESTION"
    proposito: "Análisis de alertas y recomendación de acciones"
    modelo: "claude-3.5-sonnet"
    autonomia: BAJA_HITL
    tareas:
      - "Analizar causa raíz de alerta"
      - "Sugerir playbook apropiado"
      - "Estimar impacto"
      - "Priorizar atención"

# ═══════════════════════════════════════════════════════════════════════════════
# GOBERNANZA AI (HAIC - Human-AI Collaboration)
# ═══════════════════════════════════════════════════════════════════════════════

Gobernanza_AI:
  principios:
    - "Transparencia: Explicar decisiones y razonamiento"
    - "Supervisión humana: HITL para decisiones críticas"
    - "Privacidad: Cumplir Ley 21.719 en tratamiento de datos"
    - "Trazabilidad: Registrar todas las acciones"
    - "Mejora continua: Feedback loop para optimización"

  niveles_autonomia:
    ALTA:
      descripcion: "Agente actúa sin aprobación"
      aplicacion: "Tareas rutinarias, bajo riesgo"
      ejemplos: ["Generar reportes", "Enviar notificaciones"]
    
    MEDIA:
      descripcion: "Agente actúa, humano revisa después"
      aplicacion: "Tareas con impacto moderado"
      ejemplos: ["Validar documentos", "Clasificar solicitudes"]
    
    BAJA_HITL:
      descripcion: "Humano aprueba antes de actuar"
      aplicacion: "Decisiones con impacto significativo"
      ejemplos: ["Aprobar desembolso", "Modificar convenio"]

  auditoría:
    - "Log de todas las interacciones"
    - "Registro de decisiones tomadas"
    - "Métricas de precisión y recall"
    - "Análisis de sesgos"
    - "Revisión periódica de políticas"

# ═══════════════════════════════════════════════════════════════════════════════
# API ENDPOINTS
# ═══════════════════════════════════════════════════════════════════════════════

API_Endpoints:

  Datasets:
    base: "/api/v1/evol/datasets"
    endpoints:
      - { method: GET, path: "/", desc: "Catálogo de datasets" }
      - { method: GET, path: "/{id}", desc: "Detalle y esquema" }
      - { method: GET, path: "/{id}/linaje", desc: "Grafo de linaje" }

  Servicios:
    base: "/api/v1/evol/servicios"
    endpoints:
      - { method: GET, path: "/", desc: "Catálogo de APIs" }
      - { method: GET, path: "/{id}/docs", desc: "Documentación" }

  Automatizaciones:
    base: "/api/v1/evol/automatizaciones"
    endpoints:
      - { method: GET, path: "/", desc: "Listar automatizaciones" }
      - { method: POST, path: "/{id}/ejecutar", desc: "Ejecutar manualmente" }
      - { method: GET, path: "/ejecuciones", desc: "Historial" }

  Agentes:
    base: "/api/v1/evol/agentes"
    endpoints:
      - { method: GET, path: "/", desc: "Catálogo de agentes" }
      - { method: POST, path: "/{codigo}/chat", desc: "Enviar mensaje" }
      - { method: GET, path: "/{codigo}/interacciones", desc: "Historial" }
      - { method: POST, path: "/{codigo}/feedback", desc: "Registrar feedback" }

  RAG:
    base: "/api/v1/evol/rag"
    endpoints:
      - { method: GET, path: "/colecciones", desc: "Listar colecciones" }
      - { method: POST, path: "/colecciones/{id}/indexar", desc: "Reindexar" }
      - { method: POST, path: "/query", desc: "Búsqueda semántica" }

# ═══════════════════════════════════════════════════════════════════════════════
# ROADMAP EVOLUCIÓN
# ═══════════════════════════════════════════════════════════════════════════════

Roadmap:
  Fase_1_Fundamentos:
    periodo: "Q1-Q2 2025"
    entregables:
      - "Lakehouse Bronze/Silver implementado"
      - "Catálogo de datos"
      - "3 automatizaciones core"
      - "GORE_Assistant (piloto)"

  Fase_2_Expansion:
    periodo: "Q3-Q4 2025"
    entregables:
      - "Capa Gold completa"
      - "10 automatizaciones"
      - "IPR_Advisor en producción"
      - "Rendicion_Validator"

  Fase_3_Inteligencia:
    periodo: "2026"
    entregables:
      - "Agentes operacionales maduros"
      - "ML predictivo"
      - "Dashboard AI-powered"
      - "Autonomía incremental"

# ═══════════════════════════════════════════════════════════════════════════════
# FIN ESPECIFICACIÓN D-EVOL
# ═══════════════════════════════════════════════════════════════════════════════
