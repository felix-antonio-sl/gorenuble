# GOS-110: GORE_OS - Especificación D-GESTION (Gestión Institucional)
# ═══════════════════════════════════════════════════════════════════════════════

Manifest:
  URN: "urn:knowledge:gorenuble:goreos:110:especificacion:d_gestion"
  Version: "1.0.0"
  Status: Draft

Metadata:
  Title: "GORE_OS - Especificación D-GESTION"
  Description: "Casos de uso, flujos y APIs del dominio Gestión Institucional"
  Domain: GORE_OS
  Subdomain: D-GESTION
  Created: "2024-12-14"
  Tags: [goreos, d_gestion, okr, h_gore, playbook, alerta]

# ═══════════════════════════════════════════════════════════════════════════════
# VISIÓN DEL DOMINIO
# ═══════════════════════════════════════════════════════════════════════════════

Vision_Dominio:
  Proposito: "Monitorear salud institucional, gestionar OKRs, alertas y playbooks"
  
  Actores:
    - "Gobernador/GORE: Visualiza H_gore, define OKRs organizacionales"
    - "Jefe División: Define OKRs división, atiende alertas"
    - "Controller Gestión: Administra indicadores, ejecuta playbooks"
  
  KPIs:
    - { nombre: "H_gore", meta: ">= 75" }
    - { nombre: "Cumplimiento OKRs", meta: ">= 70%" }
    - { nombre: "Tiempo respuesta alertas", meta: "<= 24h" }

# ═══════════════════════════════════════════════════════════════════════════════
# CASOS DE USO PRINCIPALES
# ═══════════════════════════════════════════════════════════════════════════════

Casos_Uso:

  CU_GEST_001:
    nombre: "Definir OKRs organizacionales"
    actor: "Gobernador"
    flujo: ["Seleccionar período", "Definir objetivo", "Agregar KRs", "Asignar owners"]

  CU_GEST_002:
    nombre: "Cascadear OKRs a divisiones"
    actor: "Jefe División"
    flujo: ["Ver OKRs org", "Crear OKR división vinculado", "Definir KRs contribuyentes"]

  CU_GEST_003:
    nombre: "Registrar check-in OKR"
    actor: "Owner KR"
    frecuencia: "Semanal"
    flujo: ["Actualizar valor", "Registrar confianza", "Documentar bloqueadores"]

  CU_GEST_010:
    nombre: "Calcular H_gore"
    actor: "Sistema"
    trigger: "Diario batch"
    formula: "H_gore = Σ(peso_i × score_dominio_i)"
    pesos:
      D_PLAN: 10
      D_FIN: 20
      D_EJEC: 25
      D_COORD: 10
      D_BACK: 10
      D_TDE: 10
      GOB: 15

  CU_GEST_020:
    nombre: "Generar alerta automática"
    actor: "Sistema"
    triggers:
      - "Indicador cruza umbral crítico"
      - "H_gore < 60"
      - "Convenio en mora > 90 días"
      - "RS por vencer < 30 días"

  CU_GEST_030:
    nombre: "Ejecutar playbook"
    actor: "Controller Gestión"
    flujo: ["Seleccionar playbook", "Registrar inicio", "Ejecutar pasos", "Documentar resultado"]

# ═══════════════════════════════════════════════════════════════════════════════
# CÁLCULO H_GORE
# ═══════════════════════════════════════════════════════════════════════════════

Calculo_H_Gore:
  descripcion: "Índice agregado de salud institucional (0-100)"
  
  indicadores_por_dominio:
    D_PLAN:
      - { codigo: "PLAN-01", nombre: "Cobertura alineación ERD", peso: 0.5 }
      - { codigo: "PLAN-02", nombre: "Avance indicadores ERD", peso: 0.5 }
    D_FIN:
      - { codigo: "FIN-01", nombre: "Ejecución presupuestaria", peso: 0.4 }
      - { codigo: "FIN-02", nombre: "Cartera con RS vigente", peso: 0.3 }
      - { codigo: "FIN-03", nombre: "Tasa aprobación CORE", peso: 0.3 }
    D_EJEC:
      - { codigo: "EJEC-01", nombre: "Avance físico cartera", peso: 0.3 }
      - { codigo: "EJEC-02", nombre: "Avance financiero", peso: 0.3 }
      - { codigo: "EJEC-03", nombre: "Convenios sin mora", peso: 0.4 }
    D_COORD:
      - { codigo: "COORD-01", nombre: "Cumplimiento compromisos", peso: 1.0 }
    D_BACK:
      - { codigo: "BACK-01", nombre: "Documentos tramitados a tiempo", peso: 1.0 }
    D_TDE:
      - { codigo: "TDE-01", nombre: "Servicios digitalizados", peso: 0.5 }
      - { codigo: "TDE-02", nombre: "Expedientes electrónicos", peso: 0.5 }
    GOB:
      - { codigo: "GOB-01", nombre: "Cumplimiento OKRs", peso: 0.5 }
      - { codigo: "GOB-02", nombre: "Satisfacción ciudadana", peso: 0.5 }

  umbrales:
    CRITICO: "<40"
    ALERTA: "40-60"
    ACEPTABLE: "60-80"
    SALUDABLE: ">=80"

# ═══════════════════════════════════════════════════════════════════════════════
# PLAYBOOKS
# ═══════════════════════════════════════════════════════════════════════════════

Playbooks:
  P01_Recovery_H_Gore_Critico:
    trigger: "H_gore < 40"
    tipo: RECOVERY
    duracion: "2 semanas"
    pasos:
      1: "Convocar comité de crisis"
      2: "Identificar dominios críticos"
      3: "Definir acciones inmediatas por dominio"
      4: "Asignar responsables"
      5: "Monitoreo diario"

  P02_Reduccion_Mora:
    trigger: "Mora rendiciones > 20%"
    tipo: RECOVERY
    duracion: "1 mes"
    pasos:
      1: "Listar convenios en mora"
      2: "Contactar unidades ejecutoras"
      3: "Priorizar por monto"
      4: "Agendar reuniones de seguimiento"
      5: "Escalar no respondidos"

  P03_Aceleracion_Ejecucion:
    trigger: "Ejecución presupuestaria < 70% en Q3"
    tipo: ACCELERATION
    duracion: "2 meses"
    pasos:
      1: "Identificar proyectos con atraso"
      2: "Revisar cuellos de botella"
      3: "Simplificar procesos"
      4: "Reasignar recursos"
      5: "Monitoreo semanal"

# ═══════════════════════════════════════════════════════════════════════════════
# API ENDPOINTS
# ═══════════════════════════════════════════════════════════════════════════════

API_Endpoints:

  OKRs:
    base: "/api/v1/gestion/okrs"
    endpoints:
      - { method: GET, path: "/", desc: "Listar OKRs" }
      - { method: GET, path: "/{id}", desc: "Detalle OKR" }
      - { method: POST, path: "/", desc: "Crear OKR" }
      - { method: POST, path: "/{id}/check-in", desc: "Registrar check-in" }
      - { method: GET, path: "/dashboard", desc: "Dashboard OKRs" }

  H_Gore:
    base: "/api/v1/gestion/h-gore"
    endpoints:
      - { method: GET, path: "/actual", desc: "H_gore actual" }
      - { method: GET, path: "/historico", desc: "Serie histórica" }
      - { method: GET, path: "/desglose", desc: "Por dominio" }

  Alertas:
    base: "/api/v1/gestion/alertas"
    endpoints:
      - { method: GET, path: "/", desc: "Listar alertas" }
      - { method: POST, path: "/{id}/atender", desc: "Atender alerta" }
      - { method: POST, path: "/{id}/resolver", desc: "Resolver alerta" }

  Playbooks:
    base: "/api/v1/gestion/playbooks"
    endpoints:
      - { method: GET, path: "/", desc: "Catálogo playbooks" }
      - { method: POST, path: "/{codigo}/ejecutar", desc: "Iniciar ejecución" }
      - { method: GET, path: "/ejecuciones", desc: "Ejecuciones activas" }

# ═══════════════════════════════════════════════════════════════════════════════
# EVENTOS DE DOMINIO
# ═══════════════════════════════════════════════════════════════════════════════

Eventos:
  - { evento: "HGoreCalculado", payload: [fecha, h_gore, estado] }
  - { evento: "AlertaGenerada", payload: [alerta_id, tipo, severidad] }
  - { evento: "PlaybookIniciado", payload: [ejecucion_id, playbook_codigo] }
  - { evento: "OKRCheckIn", payload: [okr_id, kr_id, valor, confianza] }

# ═══════════════════════════════════════════════════════════════════════════════
# FIN ESPECIFICACIÓN D-GESTION
# ═══════════════════════════════════════════════════════════════════════════════
