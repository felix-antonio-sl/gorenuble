# GOS-105: GORE_OS - Especificación D-NORM (Normativo)
# ═══════════════════════════════════════════════════════════════════════════════

Manifest:
  URN: "urn:knowledge:gorenuble:goreos:105:especificacion:d_norm"
  Version: "1.0.0"
  Status: Draft

Metadata:
  Title: "GORE_OS - Especificación D-NORM (Normativo)"
  Description: "Casos de uso, flujos y APIs del dominio Normativo"
  Domain: GORE_OS
  Subdomain: D-NORM
  Created: "2024-12-14"
  Tags: [goreos, d_norm, reglamentos, normativa, consulta_publica]

# ═══════════════════════════════════════════════════════════════════════════════
# VISIÓN DEL DOMINIO
# ═══════════════════════════════════════════════════════════════════════════════

Vision_Dominio:
  Proposito: >
    Gestionar la potestad normativa regional: elaboración de reglamentos,
    procesos normativos, biblioteca normativa y consultas públicas.
  
  Objetivos:
    - "Digitalizar proceso de elaboración de reglamentos"
    - "Mantener biblioteca normativa actualizada"
    - "Gestionar consultas públicas"
    - "Trazabilidad de versiones normativas"
  
  Actores:
    - actor: "Jefe Jurídica"
      rol: "Responsable del proceso normativo"
    - actor: "Abogado GORE"
      rol: "Elabora y revisa proyectos normativos"
    - actor: "CORE"
      rol: "Aprueba reglamentos regionales"
    - actor: "Ciudadano"
      rol: "Participa en consultas públicas"
  
  KPIs:
    - nombre: "Reglamentos vigentes digitalizados"
      formula: "Reglamentos en sistema / Total * 100"
      meta: "100%"
    - nombre: "Participación en consultas"
      formula: "Observaciones recibidas promedio"
      meta: ">= 50 por consulta"

# ═══════════════════════════════════════════════════════════════════════════════
# CASOS DE USO
# ═══════════════════════════════════════════════════════════════════════════════

Casos_Uso:

  # ─────────────────────────────────────────────────────────────────────────────
  # REGLAMENTOS REGIONALES
  # ─────────────────────────────────────────────────────────────────────────────

  CU_NORM_001:
    nombre: "Iniciar proceso normativo"
    actor_principal: "Abogado GORE"
    descripcion: "Crear nuevo proyecto de reglamento"
    flujo_principal:
      1: "Usuario crea nuevo proceso normativo"
      2: "Usuario define tipo (reglamento, ordenanza, política)"
      3: "Usuario ingresa materia y fundamentación"
      4: "Usuario sube borrador inicial"
      5: "Sistema crea proceso en estado ELABORACION"

  CU_NORM_002:
    nombre: "Gestionar versiones del proyecto"
    actor_principal: "Abogado GORE"
    descripcion: "Control de versiones del documento normativo"
    flujo_principal:
      1: "Usuario sube nueva versión"
      2: "Sistema versiona automáticamente"
      3: "Sistema mantiene historial de cambios"
      4: "Usuario puede comparar versiones"

  CU_NORM_003:
    nombre: "Publicar para consulta pública"
    actor_principal: "Jefe Jurídica"
    descripcion: "Abrir período de participación ciudadana"
    flujo_principal:
      1: "Usuario valida proyecto está listo"
      2: "Usuario define período de consulta"
      3: "Sistema cambia estado a CONSULTA_PUBLICA"
      4: "Sistema publica en portal de transparencia"
      5: "Sistema habilita formulario de observaciones"

  CU_NORM_004:
    nombre: "Recibir observaciones ciudadanas"
    actor_principal: "Ciudadano"
    descripcion: "Enviar observación a proyecto normativo"
    flujo_principal:
      1: "Ciudadano accede a consulta pública"
      2: "Ciudadano descarga proyecto"
      3: "Ciudadano completa formulario de observación"
      4: "Sistema registra observación"
      5: "Sistema envía acuse de recibo"

  CU_NORM_005:
    nombre: "Procesar observaciones"
    actor_principal: "Abogado GORE"
    descripcion: "Evaluar y responder observaciones"
    flujo_principal:
      1: "Usuario accede a observaciones recibidas"
      2: "Usuario evalúa cada observación"
      3: "Usuario clasifica: ACOGIDA, ACOGIDA_PARCIAL, RECHAZADA"
      4: "Usuario documenta respuesta"
      5: "Sistema genera informe de participación"

  CU_NORM_006:
    nombre: "Aprobar reglamento en CORE"
    actor_principal: "Secretario CORE"
    descripcion: "Registrar aprobación del CORE"
    flujo_principal:
      1: "Proyecto se presenta a sesión CORE"
      2: "Usuario registra votación"
      3: "Si aprobado, sistema cambia estado a APROBADO"
      4: "Usuario registra número de acuerdo"
      5: "Sistema genera versión final"

  CU_NORM_007:
    nombre: "Publicar reglamento vigente"
    actor_principal: "Jefe Jurídica"
    descripcion: "Publicar y activar reglamento"
    flujo_principal:
      1: "Usuario verifica acuerdo CORE"
      2: "Usuario ingresa fecha de publicación"
      3: "Sistema cambia estado a VIGENTE"
      4: "Sistema publica en biblioteca normativa"
      5: "Si reemplaza otro, sistema marca anterior como DEROGADO"

  # ─────────────────────────────────────────────────────────────────────────────
  # BIBLIOTECA NORMATIVA
  # ─────────────────────────────────────────────────────────────────────────────

  CU_NORM_010:
    nombre: "Consultar biblioteca normativa"
    actor_principal: "Funcionario"
    descripcion: "Buscar normativa vigente"
    flujo_principal:
      1: "Usuario accede a biblioteca"
      2: "Usuario busca por materia, fecha, tipo"
      3: "Sistema muestra resultados"
      4: "Usuario puede descargar documento"
      5: "Sistema muestra historial de versiones"

  CU_NORM_011:
    nombre: "Registrar normativa externa"
    actor_principal: "Abogado GORE"
    descripcion: "Incorporar norma externa relevante"
    flujo_principal:
      1: "Usuario crea entrada en biblioteca"
      2: "Usuario clasifica (ley, decreto, circular)"
      3: "Usuario sube documento"
      4: "Usuario define relaciones con otras normas"

# ═══════════════════════════════════════════════════════════════════════════════
# FLUJO DE PROCESO NORMATIVO
# ═══════════════════════════════════════════════════════════════════════════════

Flujo_Normativo: |
  ┌────────────┐   ┌────────────┐   ┌────────────┐   ┌────────────┐
  │ELABORACION │──►│  REVISION  │──►│ CONSULTA   │──►│ EN_SESION  │
  └────────────┘   └────────────┘   │  PUBLICA   │   │   CORE     │
                                    └────────────┘   └────────────┘
                                                           │
                    ┌──────────────────────────────────────┤
                    │                                      │
                    ▼                                      ▼
              ┌────────────┐                        ┌────────────┐
              │ RECHAZADO  │                        │  APROBADO  │
              └────────────┘                        └────────────┘
                                                           │
                                                           ▼
                                                    ┌────────────┐
                                                    │  VIGENTE   │
                                                    └────────────┘
                                                           │
                                                           ▼
                                                    ┌────────────┐
                                                    │  DEROGADO  │
                                                    └────────────┘

# ═══════════════════════════════════════════════════════════════════════════════
# API ENDPOINTS
# ═══════════════════════════════════════════════════════════════════════════════

API_Endpoints:

  Procesos:
    base_path: "/api/v1/norm/procesos"
    endpoints:
      - { method: GET, path: "/", desc: "Listar procesos normativos" }
      - { method: POST, path: "/", desc: "Iniciar proceso", permisos: ["norm:proceso:create"] }
      - { method: GET, path: "/{id}", desc: "Detalle proceso" }
      - { method: POST, path: "/{id}/versiones", desc: "Subir versión" }
      - { method: POST, path: "/{id}/publicar-consulta", desc: "Abrir consulta pública" }
      - { method: POST, path: "/{id}/aprobar", desc: "Registrar aprobación CORE" }

  ConsultasPublicas:
    base_path: "/api/v1/norm/consultas"
    endpoints:
      - { method: GET, path: "/", desc: "Consultas públicas abiertas" }
      - { method: GET, path: "/{id}", desc: "Detalle consulta" }
      - { method: POST, path: "/{id}/observaciones", desc: "Enviar observación" }
      - { method: GET, path: "/{id}/observaciones", desc: "Listar observaciones" }

  Biblioteca:
    base_path: "/api/v1/norm/biblioteca"
    endpoints:
      - { method: GET, path: "/", desc: "Buscar normativa" }
      - { method: GET, path: "/{id}", desc: "Detalle norma" }
      - { method: GET, path: "/{id}/versiones", desc: "Historial versiones" }
      - { method: POST, path: "/", desc: "Registrar norma externa" }

# ═══════════════════════════════════════════════════════════════════════════════
# EVENTOS
# ═══════════════════════════════════════════════════════════════════════════════

Eventos:
  - { evento: "ProcesoNormativoIniciado", payload: [proceso_id, materia] }
  - { evento: "ConsultaPublicaAbierta", payload: [proceso_id, fecha_cierre] }
  - { evento: "ObservacionRecibida", payload: [consulta_id, observacion_id] }
  - { evento: "ReglamentoAprobado", payload: [proceso_id, acuerdo_core] }
  - { evento: "ReglamentoVigente", payload: [reglamento_id, fecha] }

# ═══════════════════════════════════════════════════════════════════════════════
# FIN ESPECIFICACIÓN D-NORM
# ═══════════════════════════════════════════════════════════════════════════════
